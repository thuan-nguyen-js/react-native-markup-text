var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _possibleConstructorReturn2=_interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));var _getPrototypeOf2=_interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));var _inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits"));var _react=_interopRequireDefault(require("react"));var _propTypes=_interopRequireDefault(require("prop-types"));var _reactNative=require("react-native");var _parse=_interopRequireDefault(require("parse5"));var _elements=require("./elements");var _jsxFileName="/Users/thuan/work/lib/react-native-markup-text/index.js";function _createSuper(Derived){return function(){var Super=(0,_getPrototypeOf2.default)(Derived),result;if(_isNativeReflectConstruct()){var NewTarget=(0,_getPrototypeOf2.default)(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return(0,_possibleConstructorReturn2.default)(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}function isPureText(tagName){return tagName==='#text';}function isBlockElement(tagName){return _elements.BLOCK_ELEMENTS[tagName]!==undefined;}function isInlineElement(tagName){return _elements.INLINE_ELEMENTS[tagName]!==undefined;}function styleForTag(tagName,source){var style=source[tagName]?source[tagName]:source.default;return style;}function processNode(node,parentKey){var nodeName=node.nodeName;if(isPureText(nodeName)){var key=parentKey+"_text";return _react.default.createElement(_reactNative.Text,{key:key,__source:{fileName:_jsxFileName,lineNumber:29,columnNumber:12}},node.value);}if(isInlineElement(nodeName)){var _key=parentKey+"_"+nodeName;var children=[];node.childNodes.forEach(function(child,index){if(isInlineElement(child.nodeName)||isPureText(child.nodeName)){children.push(processNode(child,_key+"_"+index));}else{console.error('MarkupText',"Inline element "+nodeName+" can only have inline children, "+child+" is invalid!");}});return _react.default.createElement(_reactNative.Text,{key:_key,style:styleForTag(nodeName,_elements.INLINE_ELEMENTS),__source:{fileName:_jsxFileName,lineNumber:46,columnNumber:7}},children);}if(isBlockElement(nodeName)){var _key2=parentKey+"_"+nodeName;var _children2=[];var lastInlineNodes=[];node.childNodes.forEach(function(childNode,index){var child=processNode(childNode,_key2+"_"+index);if(isInlineElement(childNode.nodeName)||isPureText(childNode.nodeName)){lastInlineNodes.push(child);}else if(isBlockElement(childNode.nodeName)){if(lastInlineNodes.length>0){_children2.push(_react.default.createElement(_reactNative.Text,{key:_key2+"_"+index+"_inline",__source:{fileName:_jsxFileName,lineNumber:64,columnNumber:25}},lastInlineNodes));lastInlineNodes=[];}_children2.push(child);}});if(lastInlineNodes.length>0){_children2.push(_react.default.createElement(_reactNative.Text,{key:_key2+"_last_inline",__source:{fileName:_jsxFileName,lineNumber:72,columnNumber:21}},lastInlineNodes));}return _react.default.createElement(_reactNative.View,{key:_key2,style:styleForTag(nodeName,_elements.BLOCK_ELEMENTS),__source:{fileName:_jsxFileName,lineNumber:76,columnNumber:7}},_children2);}console.warn('MarkupText',"unsupported node: "+nodeName);return null;}var MarkupText=function(_React$PureComponent){(0,_inherits2.default)(MarkupText,_React$PureComponent);var _super=_createSuper(MarkupText);function MarkupText(){var _this;(0,_classCallCheck2.default)(this,MarkupText);for(var _len=arguments.length,args=new Array(_len),_key3=0;_key3<_len;_key3++){args[_key3]=arguments[_key3];}_this=_super.call.apply(_super,[this].concat(args));_this.parse=function(text){var fragment=_parse.default.parseFragment(text);return fragment;};return _this;}(0,_createClass2.default)(MarkupText,[{key:"render",value:function render(){var _this$props=this.props,children=_this$props.children,style=_this$props.style;var _children=typeof children==='string'?children:'';var fragment=this.parse(_children);var rootKey='ht_';var elements=[];fragment.childNodes.forEach(function(node,index){elements.push(processNode(node,rootKey+"_"+index));});return _react.default.createElement(_reactNative.Text,{style:style,__source:{fileName:_jsxFileName,lineNumber:103,columnNumber:12}},elements);}}]);return MarkupText;}(_react.default.PureComponent);MarkupText.propTypes={style:_reactNative.Text.propTypes.style,children:_propTypes.default.string};MarkupText.defaultProps={style:undefined,children:''};var _default=MarkupText;exports.default=_default;